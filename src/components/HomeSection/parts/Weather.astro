<!-- Weather Widget Component -->
<div
  class="flex flex-row items-center justify-between"
  id="daily-weather-cards"
>
  <!-- Weather cards will be dynamically populated here -->
</div>

<script>
  interface DailyWeather {
    date: string
    dayString: string
    dateString: string
    weatherCategory: string
    maxTemp: number
    minTemp: number
  }

  interface ProcessedWeatherData {
    daily: DailyWeather[]
    current: {
      temperature: number
      humidity: number
      apparentTemp: number
      isDay: boolean
      precipitation: number
      cloudCover: number
    }
  }

  // Function to create a weather card element
  function createWeatherCard(weather: DailyWeather): string {
    return `
      <div class="card bg-white/15 backdrop-blur-sm rounded-xl w-29">
        <div class="card-body p-4 flex flex-col items-center">
          <div class="flex flex-col items-center">
            <span class="text-lg font-bold" aria-label="dayString">${weather.dayString}</span>
            <span class="text-sm" aria-label="dateString">${weather.dateString}</span>
          </div>
          <img
            src="/assets/static/${weather.weatherCategory}.svg"
            alt="Weather"
            class="w-16 h-16 -mt-4"
          />
          <span class="text-xs -mt-2 text-gray-300" aria-label="weatherCategory">${weather.weatherCategory.split('-').join(' ')}</span>
          <div class="flex flex-row items-center gap-2">
            <span class="text-lg font-bold leading-none" aria-label="maxTemperature">${weather.maxTemp}°</span>
            <span class="text-lg font-bold leading-none" aria-label="minTemperature">${weather.minTemp}°</span>
          </div>
        </div>
      </div>
    `
  }

  // Function to update the daily weather cards
  function updateDailyWeatherCards(data: ProcessedWeatherData) {
    const container = document.getElementById('daily-weather-cards')
    if (!container) return

    // Get the next 6 days (skip today which is index 0)
    const next6Days = data.daily.slice(0, 6)

    // Generate HTML for all cards
    const cardsHtml = next6Days.map(createWeatherCard).join('')

    // Update the container
    container.innerHTML = cardsHtml
  }

  // Listen for the weatherDataReady event
  document.addEventListener('weatherDataReady', (event: Event) => {
    const customEvent = event as CustomEvent<ProcessedWeatherData>
    updateDailyWeatherCards(customEvent.detail)
  })
</script>
